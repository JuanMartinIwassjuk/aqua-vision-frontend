<div class="gamification-header">
  <button class="back-btn" routerLink="/gamificacion">â¬… Volver</button>
  <h2>AquaMatch</h2>
</div>

<div class="aquamatch-layout">
  <div class="aquamatch-board" #container (mousemove)="onMouseMove($event)" (mouseup)="onMouseUp()">

    <div *ngIf="showIntro" class="intro-screen">
      <p>ğŸ’§ En este juego vas a aprender cÃ³mo cuidar el agua uniendo tarjetas relacionadas.</p>
      <button class="start-btn" (click)="startGame()">Comenzar juego</button>
    </div>


    <div *ngIf="showNextLevel" class="intro-screen">
      <p>ğŸ‰ Â¡Excelente! Completaste el nivel {{ currentLevel }}.</p>
      <p>Â¿Listo para seguir aprendiendo y ganar mÃ¡s puntos?</p>
      <button class="start-btn" (click)="nextLevel()">Siguiente nivel ğŸš€</button>
    </div>

    <div *ngIf="finalMessage" class="intro-screen">
      <p>ğŸ† Â¡Felicitaciones! Completaste todos los niveles de AquaMatch.</p>
      <p>Ahora sos un experto en el cuidado del agua.</p>
      <button class="start-btn" (click)="restartGame()">Volver a jugar ğŸ”</button>
    </div>


    <ng-container *ngIf="!showIntro">
      <div *ngFor="let card of leftCards" class="card left-card" [style.left.px]="card.x" [style.top.px]="card.y"
        (mousedown)="startDrag($event, card)">
        <div class="card-text">{{ card.text }}</div>
      </div>

      <div *ngFor="let card of rightCards" class="card right-card" [style.left.px]="card.x" [style.top.px]="card.y">
        <div class="card-text">{{ card.text }}</div>
      </div>
    </ng-container>

  </div>

  <div class="aquamatch-info">
    <h3>ğŸ’§ Consejos obtenidos</h3>
    <div *ngIf="mergedCards.length === 0" class="locked-info">
      ğŸ”’ UnÃ­ las tarjetas para descubrir consejos sobre cÃ³mo cuidar el agua.
    </div>
    <div *ngFor="let merged of mergedCards" class="merged-card">
      <div class="merged-card-header">
        <div class="left-text">{{ merged.leftText }}</div>
        <div class="right-text">{{ merged.rightText }}</div>
      </div>
      <div class="merged-card-tip">
        ğŸ’¡ {{ merged.tip }}
      </div>
      <button class="claim-btn" (click)="claimPoints(merged)" [disabled]="merged.claimed">
        {{ merged.claimed ? 'âœ… Reclamado' : 'ğŸ Reclamar puntos' }}
      </button>
    </div>
  </div>
</div>
<div class="wrapper-event">
<div class="filters">

    <div class="filter-tags" >
      <label for="tagFilter">Categorías:</label>
      <select
        id="tagFilter"
        [(ngModel)]="tagToAdd"
        (change)="addTagToSelection()"
        class="tag-select"
      >
        <option value="" disabled selected>Selecciona una categoría</option>
        <option *ngFor="let tag of availableTags" [ngValue]="tag">
          {{ tag.nombre }}
        </option>
      </select>
    </div>

    <div class="filter-status">
      <label for="statusFilter">Estado:</label>
      <select
        id="statusFilter"
        [(ngModel)]="selectedStatus"
        class="status-select"
      >
        <option value="">Todos</option>
        <option *ngFor="let status of availableStatuses" [value]="status">
          {{ status }}
        </option>
      </select>
    </div>

    <div class="sort-wrapper">
      <label>Ordenar:</label>
      <button class="sort-button" (click)="toggleSortOrder()">
        Fecha {{ sortOrder === 'asc' ? '↑' : '↓' }}
      </button>
    </div>

    <button class="clear-filter" (click)="clearFilter()">Limpiar</button>

 
    <div class="selected-categories" *ngIf="selectedTags.length > 0">
      <div
        class="tag-chip"
        *ngFor="let tag of selectedTags"
        [ngStyle]="{'background-color': tag.color}"
      >
        {{ tag.nombre }}
        <span class="remove-tag" (click)="removeTag(tag)">×</span>
      </div>
    </div>
  </div>

  <div class="events-wrapper">
    <div class="event-card"
      *ngFor="let event of filteredEvents"
      [ngStyle]="{'border-left': '6px solid ' + getStatusColor(event.estado)}"
    >
      <div class="event-header">
        <h3 class="event-title">{{ event.titulo }}</h3>
        <div class="actions">
          <button class="icon-button edit-button" (click)="editEvent(event.id!)">
            <span class="material-icons">edit</span>
          </button>
          <button class="icon-button delete-button" (click)="deleteEvent(event.id!)">
            <span class="material-icons">delete</span>
          </button>
        </div>
      </div>

      <p class="event-description">{{ event.description }}</p>

 
      <p class="event-sector">
        <strong>Sector:</strong> {{ event.sector.nombre }}
      </p>

      <h4 class="event-status" [style.color]="getStatusColor(event.estado)">
        {{ event.estado }}
      </h4>

      <div class="event-dates">
        <span><strong>Inicio:</strong> {{ event.startDate | date:'short' }}</span>
        <span *ngIf="event.endDate"><br><strong>Fin:</strong> {{ event.endDate | date:'short' }}</span>
      </div>

     
      <div class="event-results" *ngIf="event.estado === 'Finalizado'">
        <p><strong>Consumo:</strong> {{ event.litersConsumed }} litros</p>
        <p><strong>Costo:</strong> ${{ event.cost }}</p>
      </div>

      <div class="tags-container">
        <span *ngFor="let tag of event.tags"
              class="tag"
              [ngStyle]="{'background-color': tag.color}">
          {{ tag.nombre }}
        </span>
      </div>

      <div *ngIf="event.estado === 'En proceso'" class="finalize-wrapper">
        <button class="finalize-btn" (click)="finalizeEvent(event)">
          Finalizar evento
        </button>
      </div>

      <div *ngIf="event.estado === 'Pendiente'" class="start-wrapper">
        <button class="start-btn" (click)="startEvent(event)">
          Comenzar evento
        </button>
      </div>
    </div>

  </div>
</div>

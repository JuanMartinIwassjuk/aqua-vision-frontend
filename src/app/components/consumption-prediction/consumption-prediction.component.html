<div class="reportes-container">
  <h2 class="titulo-principal">PredicciÃ³n de Consumo</h2>

  <div class="acciones-superiores">
    <button class="btn-filtro" (click)="mostrarFiltros = !mostrarFiltros">
      <i class="fa-solid fa-filter"></i>
      Filtros
      <i
        class="fa-solid"
        [ngClass]="mostrarFiltros ? 'fa-chevron-up' : 'fa-chevron-down'">
      </i>
    </button>
  </div>

  <!-- Filtros -->
  <div class="filtros-sectores slide-down" *ngIf="mostrarFiltros">
    <h4>Filtrar por sector</h4>
    <div class="checkbox-grid">
      <label *ngFor="let sector of sectores">
        <input
          type="checkbox"
          [checked]="sectoresFiltrados.includes(sector.nombre)"
          (change)="toggleFiltroSector(sector.nombre)"
        />
        {{ sector.nombre }}
      </label>
    </div>

    <hr style="margin: 1.5rem 0; border: none; border-top: 1px solid #ddd;">

    <h4>Filtrar por tipo de dato</h4>
    <div class="checkbox-grid">
      <label *ngFor="let key of (filtrosParametros | keyvalue)">
        <input
          type="checkbox"
          [checked]="key.value"
          (change)="toggleFiltroParametro(key.key)"
        />
        {{ key.key }}
      </label>
    </div>
  </div>

  <!-- Renderizado de sectores filtrados -->
  <div *ngFor="let sector of sectoresFiltradosData" class="chart-card fade-in">
  <h3 class="sector-titulo">{{ sector.nombre }}</h3>

  <div class="chart-wrapper">
    <canvas
      baseChart
      [data]="sector.lineChartData"
      [options]="lineChartOptions"
      [type]="'line'">
    </canvas>
  </div>

      <!-- GRID DE DATOS E HALLAZGOS -->
    <div class="resumen-grid">
      <div class="datos-consumo">
        <h4>ðŸ“Š Resumen de Consumo</h4>
        <ul>
          <li><strong>ðŸ’§ Gasto actual:</strong> ${{ sector.costoActual }}</li>
          <li><strong>ðŸ“ˆ Gasto proyectado:</strong> ${{ sector.costoProyectado }}</li>
          <li><strong>ðŸ“‰ Tendencia mÃ­nima:</strong> 
            {{ sector.tendenciaMinima !== null ? (sector.tendenciaMinima | number:'1.0-2') + ' L' : 'N/A' }}
          </li>
          <li><strong>ðŸ“ˆ Tendencia mÃ¡xima:</strong> 
            {{ sector.tendenciaMaxima !== null ? (sector.tendenciaMaxima | number:'1.0-2') + ' L' : 'N/A' }}
          </li>
        </ul>
      </div>

      <div class="hallazgos" *ngIf="sector.hallazgosClave.length > 0">
        <h4>ðŸ’¡ Hallazgos clave</h4>
        <ul>
          <li *ngFor="let hallazgo of sector.hallazgosClave">{{ hallazgo }}</li>
        </ul>
      </div>
    </div>


</div>
